# é¡¹ç›® 7ï¼šæ²™ç®±æ‰§è¡Œç¯å¢ƒ - ç®€åŒ–å®æˆ˜æ–¹æ¡ˆ

## ğŸ¯ é¡¹ç›®ç›®æ ‡ï¼ˆç®€åŒ–ç‰ˆï¼‰

è®©ä½ é€šè¿‡**æ¸è¿›å¼å­¦ä¹ **æŒæ¡æ²™ç®±ç¯å¢ƒçš„æ ¸å¿ƒæ¦‚å¿µå’Œå®æˆ˜æŠ€èƒ½ï¼š

1. **ç†è§£æ²™ç®±æœ¬è´¨**ï¼šä»æœ€ç®€å•çš„ä»£ç éš”ç¦»å¼€å§‹
2. **æŒæ¡æ ¸å¿ƒæŠ€æœ¯**ï¼šé€æ­¥å­¦ä¹  subprocess â†’ Docker çš„æ¼”è¿›
3. **å®æˆ˜é©±åŠ¨å­¦ä¹ **ï¼šæ¯ä¸ªé˜¶æ®µéƒ½æœ‰å¯è¿è¡Œçš„ä»£ç 
4. **å¾ªåºæ¸è¿›**ï¼šä» 30 è¡Œä»£ç åˆ°å®Œæ•´æ²™ç®±ç³»ç»Ÿ

## ğŸ—ï¸ ç®€åŒ–æ¶æ„è®¾è®¡

### ä¸‰å±‚æ¸è¿›å¼æ¶æ„

```
ç¬¬ä¸€å±‚ï¼šåŸºç¡€æ²™ç®± (30è¡Œä»£ç )
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        SimpleSandbox            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚    subprocess.run()         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç¬¬äºŒå±‚ï¼šå®‰å…¨æ²™ç®± (100è¡Œä»£ç )
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        SafeSandbox              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ èµ„æºé™åˆ¶     â”‚ â”‚ å®‰å…¨æ£€æŸ¥     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç¬¬ä¸‰å±‚ï¼šDockeræ²™ç®± (200è¡Œä»£ç )
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       DockerSandbox             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ å®¹å™¨éš”ç¦»     â”‚ â”‚ é•œåƒç®¡ç†     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“š å­¦ä¹ è·¯å¾„ï¼ˆ3 ä¸ªé˜¶æ®µï¼‰

### ğŸš€ é˜¶æ®µ 1ï¼šåŸºç¡€æ²™ç®±ï¼ˆ1 å¤©ï¼‰

**ç›®æ ‡**ï¼šç†è§£æ²™ç®±çš„æœ¬è´¨æ¦‚å¿µ

**æ ¸å¿ƒæ¦‚å¿µ**ï¼š

- è¿›ç¨‹éš”ç¦»
- è¾“å…¥è¾“å‡ºæ§åˆ¶
- åŸºç¡€å®‰å…¨

**å®ç°å†…å®¹**ï¼š

```python
# 30è¡Œä»£ç å®ç°åŸºç¡€æ²™ç®±
class SimpleSandbox:
    def execute(self, code: str) -> dict:
        # ä½¿ç”¨subprocessæ‰§è¡Œä»£ç 
        pass
```

### ğŸ›¡ï¸ é˜¶æ®µ 2ï¼šå®‰å…¨æ²™ç®±ï¼ˆ2 å¤©ï¼‰

**ç›®æ ‡**ï¼šæ·»åŠ å®‰å…¨æ§åˆ¶å’Œèµ„æºé™åˆ¶

**æ ¸å¿ƒæ¦‚å¿µ**ï¼š

- è¶…æ—¶æ§åˆ¶
- å†…å­˜é™åˆ¶
- å±é™©ä»£ç æ£€æµ‹

**å®ç°å†…å®¹**ï¼š

```python
# 100è¡Œä»£ç å®ç°å®‰å…¨æ²™ç®±
class SafeSandbox(SimpleSandbox):
    def __init__(self, timeout=10, memory_limit=128):
        # æ·»åŠ å®‰å…¨é…ç½®
        pass

    def validate_code(self, code: str) -> bool:
        # æ£€æŸ¥å±é™©ä»£ç 
        pass
```

### ğŸ³ é˜¶æ®µ 3ï¼šDocker æ²™ç®±ï¼ˆ2 å¤©ï¼‰

**ç›®æ ‡**ï¼šä½¿ç”¨ Docker å®ç°å®Œå…¨éš”ç¦»

**æ ¸å¿ƒæ¦‚å¿µ**ï¼š

- å®¹å™¨æŠ€æœ¯
- é•œåƒç®¡ç†
- ç½‘ç»œéš”ç¦»

**å®ç°å†…å®¹**ï¼š

```python
# 200è¡Œä»£ç å®ç°Dockeræ²™ç®±
class DockerSandbox:
    def __init__(self):
        self.client = docker.from_env()

    def execute_in_container(self, code: str) -> dict:
        # åœ¨Dockerå®¹å™¨ä¸­æ‰§è¡Œ
        pass
```

## ğŸ“ ç®€åŒ–é¡¹ç›®ç»“æ„

```
practical7/
â”œâ”€â”€ README.md                    # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ requirements.txt             # ä¾èµ–åˆ—è¡¨
â”œâ”€â”€ .env.example                # ç¯å¢ƒé…ç½®
â”œâ”€â”€ main.py                     # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ demo.py                     # æ¼”ç¤ºç¨‹åº
â”œâ”€â”€ stage1_simple_sandbox.py     # é˜¶æ®µ1ï¼šåŸºç¡€æ²™ç®±
â”œâ”€â”€ stage2_safe_sandbox.py       # é˜¶æ®µ2ï¼šå®‰å…¨æ²™ç®±
â”œâ”€â”€ stage3_docker_sandbox.py     # é˜¶æ®µ3ï¼šDockeræ²™ç®±
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ config.py               # ç®€åŒ–é…ç½®
â”‚   â””â”€â”€ logger.py               # æ—¥å¿—å·¥å…·
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ test_stage1.py          # é˜¶æ®µ1æµ‹è¯•
â”‚   â”œâ”€â”€ test_stage2.py          # é˜¶æ®µ2æµ‹è¯•
â”‚   â””â”€â”€ test_stage3.py          # é˜¶æ®µ3æµ‹è¯•
â””â”€â”€ examples/
    â”œâ”€â”€ basic_usage.py          # åŸºç¡€ä½¿ç”¨ç¤ºä¾‹
    â”œâ”€â”€ security_demo.py        # å®‰å…¨æ¼”ç¤º
    â””â”€â”€ docker_demo.py          # Dockeræ¼”ç¤º
```

## ğŸ”§ é˜¶æ®µ 1 è¯¦ç»†å®ç°ï¼šåŸºç¡€æ²™ç®±

### æ ¸å¿ƒæ–‡ä»¶ï¼šstage1_simple_sandbox.py

```python
"""
é˜¶æ®µ1ï¼šåŸºç¡€æ²™ç®±å®ç°
ç›®æ ‡ï¼šç†è§£æ²™ç®±çš„æœ¬è´¨ - è¿›ç¨‹éš”ç¦»å’Œè¾“å…¥è¾“å‡ºæ§åˆ¶
"""

import subprocess
import tempfile
import os
import time
from typing import Dict, Any


class SimpleSandbox:
    """æœ€ç®€å•çš„æ²™ç®±å®ç° - 30è¡Œæ ¸å¿ƒä»£ç """

    def __init__(self, timeout: int = 10):
        self.timeout = timeout

    def execute(self, code: str, language: str = "python") -> Dict[str, Any]:
        """æ‰§è¡Œä»£ç å¹¶è¿”å›ç»“æœ"""
        start_time = time.time()

        # 1. åˆ›å»ºä¸´æ—¶æ–‡ä»¶
        with tempfile.NamedTemporaryFile(
            mode='w',
            suffix=f'.{self._get_extension(language)}',
            delete=False
        ) as f:
            f.write(code)
            temp_file = f.name

        try:
            # 2. æ‰§è¡Œä»£ç 
            result = subprocess.run(
                [self._get_command(language), temp_file],
                capture_output=True,
                text=True,
                timeout=self.timeout
            )

            # 3. è¿”å›ç»“æœ
            return {
                'success': result.returncode == 0,
                'output': result.stdout,
                'error': result.stderr,
                'execution_time': time.time() - start_time,
                'exit_code': result.returncode
            }

        except subprocess.TimeoutExpired:
            return {
                'success': False,
                'output': '',
                'error': f'ä»£ç æ‰§è¡Œè¶…æ—¶ï¼ˆ{self.timeout}ç§’ï¼‰',
                'execution_time': self.timeout,
                'exit_code': -1
            }
        finally:
            # 4. æ¸…ç†ä¸´æ—¶æ–‡ä»¶
            os.unlink(temp_file)

    def _get_extension(self, language: str) -> str:
        """è·å–æ–‡ä»¶æ‰©å±•å"""
        return {'python': 'py', 'javascript': 'js'}.get(language, 'txt')

    def _get_command(self, language: str) -> str:
        """è·å–æ‰§è¡Œå‘½ä»¤"""
        return {'python': 'python', 'javascript': 'node'}.get(language, 'cat')


# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    sandbox = SimpleSandbox(timeout=5)

    # æµ‹è¯•Pythonä»£ç 
    python_code = """
print("Hello from sandbox!")
result = 2 + 3
print(f"2 + 3 = {result}")
"""

    result = sandbox.execute(python_code, "python")
    print("æ‰§è¡Œç»“æœï¼š", result)
```

### å­¦ä¹ è¦ç‚¹

**ä¸ JavaScript å¯¹æ¯”ç†è§£**ï¼š

```javascript
// JavaScriptä¸­çš„ä»£ç æ‰§è¡Œ
const vm = require('vm');
const result = vm.runInNewContext('2 + 3');

// Pythonæ²™ç®±ç­‰ä»·æ¦‚å¿µ
sandbox = SimpleSandbox();
result = sandbox.execute('print(2 + 3)');
```

**æ ¸å¿ƒæ¦‚å¿µæŒæ¡**ï¼š

1. **è¿›ç¨‹éš”ç¦»**ï¼š`subprocess.run()` åˆ›å»ºæ–°è¿›ç¨‹
2. **è¾“å…¥è¾“å‡ºæ§åˆ¶**ï¼š`capture_output=True` æ•è·è¾“å‡º
3. **è¶…æ—¶ä¿æŠ¤**ï¼š`timeout` å‚æ•°é˜²æ­¢æ— é™å¾ªç¯
4. **èµ„æºæ¸…ç†**ï¼š`finally` å—ç¡®ä¿ä¸´æ—¶æ–‡ä»¶åˆ é™¤

## ğŸ”§ é˜¶æ®µ 2 è¯¦ç»†å®ç°ï¼šå®‰å…¨æ²™ç®±

### æ ¸å¿ƒæ–‡ä»¶ï¼šstage2_safe_sandbox.py

```python
"""
é˜¶æ®µ2ï¼šå®‰å…¨æ²™ç®±å®ç°
ç›®æ ‡ï¼šæ·»åŠ å®‰å…¨æ£€æŸ¥å’Œèµ„æºé™åˆ¶
"""

import psutil
import resource
import re
from stage1_simple_sandbox import SimpleSandbox


class SafeSandbox(SimpleSandbox):
    """å®‰å…¨æ²™ç®± - åœ¨åŸºç¡€æ²™ç®±ä¸Šæ·»åŠ å®‰å…¨æ§åˆ¶"""

    def __init__(self, timeout: int = 10, memory_limit: int = 128):
        super().__init__(timeout)
        self.memory_limit = memory_limit * 1024 * 1024  # è½¬æ¢ä¸ºå­—èŠ‚

        # å±é™©å…³é”®è¯åˆ—è¡¨
        self.dangerous_keywords = [
            'os.system', 'subprocess', 'eval', 'exec',
            'open(', '__import__', 'input(', 'raw_input'
        ]

    def execute(self, code: str, language: str = "python") -> Dict[str, Any]:
        """å®‰å…¨æ‰§è¡Œä»£ç """
        # 1. ä»£ç å®‰å…¨æ£€æŸ¥
        if not self._validate_code(code):
            return {
                'success': False,
                'output': '',
                'error': 'ä»£ç åŒ…å«å±é™©æ“ä½œï¼Œæ‰§è¡Œè¢«æ‹’ç»',
                'execution_time': 0,
                'exit_code': -1
            }

        # 2. è®¾ç½®èµ„æºé™åˆ¶
        self._set_resource_limits()

        # 3. æ‰§è¡Œä»£ç ï¼ˆè°ƒç”¨çˆ¶ç±»æ–¹æ³•ï¼‰
        result = super().execute(code, language)

        # 4. æ·»åŠ å®‰å…¨ä¿¡æ¯
        result['security_check'] = True
        result['memory_limit'] = self.memory_limit

        return result

    def _validate_code(self, code: str) -> bool:
        """éªŒè¯ä»£ç å®‰å…¨æ€§"""
        # æ£€æŸ¥å±é™©å…³é”®è¯
        for keyword in self.dangerous_keywords:
            if keyword in code:
                return False

        # æ£€æŸ¥å¯¼å…¥è¯­å¥
        import_pattern = r'import\s+(os|sys|subprocess|socket)'
        if re.search(import_pattern, code):
            return False

        return True

    def _set_resource_limits(self):
        """è®¾ç½®è¿›ç¨‹èµ„æºé™åˆ¶"""
        try:
            # è®¾ç½®å†…å­˜é™åˆ¶
            resource.setrlimit(resource.RLIMIT_AS, (self.memory_limit, self.memory_limit))

            # è®¾ç½®CPUæ—¶é—´é™åˆ¶
            resource.setrlimit(resource.RLIMIT_CPU, (self.timeout, self.timeout))
        except:
            # æŸäº›ç³»ç»Ÿå¯èƒ½ä¸æ”¯æŒèµ„æºé™åˆ¶
            pass


# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    sandbox = SafeSandbox(timeout=5, memory_limit=64)

    # æµ‹è¯•å®‰å…¨ä»£ç 
    safe_code = """
numbers = [1, 2, 3, 4, 5]
total = sum(numbers)
print(f"æ€»å’Œ: {total}")
"""

    # æµ‹è¯•å±é™©ä»£ç 
    dangerous_code = """
import os
os.system("ls -la")
"""

    print("å®‰å…¨ä»£ç æ‰§è¡Œç»“æœï¼š")
    print(sandbox.execute(safe_code))

    print("\nå±é™©ä»£ç æ‰§è¡Œç»“æœï¼š")
    print(sandbox.execute(dangerous_code))
```

## ğŸ”§ é˜¶æ®µ 3 è¯¦ç»†å®ç°ï¼šDocker æ²™ç®±

### æ ¸å¿ƒæ–‡ä»¶ï¼šstage3_docker_sandbox.py

```python
"""
é˜¶æ®µ3ï¼šDockeræ²™ç®±å®ç°
ç›®æ ‡ï¼šä½¿ç”¨Dockerå®¹å™¨å®ç°å®Œå…¨éš”ç¦»
"""

import docker
import tempfile
import os
import time
from typing import Dict, Any


class DockerSandbox:
    """Dockeræ²™ç®± - å®Œå…¨éš”ç¦»çš„æ‰§è¡Œç¯å¢ƒ"""

    def __init__(self, timeout: int = 30, memory_limit: str = "128m"):
        self.timeout = timeout
        self.memory_limit = memory_limit
        self.client = docker.from_env()

        # è¯­è¨€é•œåƒæ˜ å°„
        self.images = {
            'python': 'python:3.9-slim',
            'javascript': 'node:18-slim'
        }

        # ç¡®ä¿é•œåƒå­˜åœ¨
        self._ensure_images()

    def execute(self, code: str, language: str = "python") -> Dict[str, Any]:
        """åœ¨Dockerå®¹å™¨ä¸­æ‰§è¡Œä»£ç """
        start_time = time.time()

        if language not in self.images:
            return {
                'success': False,
                'output': '',
                'error': f'ä¸æ”¯æŒçš„è¯­è¨€: {language}',
                'execution_time': 0
            }

        # 1. åˆ›å»ºä¸´æ—¶æ–‡ä»¶
        with tempfile.NamedTemporaryFile(
            mode='w',
            suffix=f'.{self._get_extension(language)}',
            delete=False
        ) as f:
            f.write(code)
            temp_file = f.name

        try:
            # 2. åœ¨å®¹å™¨ä¸­æ‰§è¡Œ
            result = self._run_in_container(temp_file, language)
            result['execution_time'] = time.time() - start_time
            return result

        finally:
            # 3. æ¸…ç†ä¸´æ—¶æ–‡ä»¶
            os.unlink(temp_file)

    def _run_in_container(self, code_file: str, language: str) -> Dict[str, Any]:
        """åœ¨Dockerå®¹å™¨ä¸­è¿è¡Œä»£ç """
        try:
            # å®¹å™¨é…ç½®
            container_config = {
                'image': self.images[language],
                'command': self._get_command(language, os.path.basename(code_file)),
                'volumes': {
                    os.path.dirname(code_file): {
                        'bind': '/workspace',
                        'mode': 'ro'  # åªè¯»æ¨¡å¼
                    }
                },
                'working_dir': '/workspace',
                'mem_limit': self.memory_limit,
                'network_disabled': True,  # ç¦ç”¨ç½‘ç»œ
                'remove': True,  # è‡ªåŠ¨åˆ é™¤å®¹å™¨
                'user': '1000:1000'  # érootç”¨æˆ·
            }

            # è¿è¡Œå®¹å™¨
            container = self.client.containers.run(**container_config, detach=True)

            # ç­‰å¾…æ‰§è¡Œå®Œæˆ
            exit_status = container.wait(timeout=self.timeout)

            # è·å–è¾“å‡º
            logs = container.logs().decode('utf-8')

            return {
                'success': exit_status['StatusCode'] == 0,
                'output': logs if exit_status['StatusCode'] == 0 else '',
                'error': logs if exit_status['StatusCode'] != 0 else '',
                'exit_code': exit_status['StatusCode'],
                'container_id': container.id[:12]
            }

        except docker.errors.ContainerError as e:
            return {
                'success': False,
                'output': '',
                'error': f'å®¹å™¨æ‰§è¡Œé”™è¯¯: {str(e)}',
                'exit_code': e.exit_status
            }
        except Exception as e:
            return {
                'success': False,
                'output': '',
                'error': f'Dockeræ‰§è¡Œå¼‚å¸¸: {str(e)}',
                'exit_code': -1
            }

    def _ensure_images(self):
        """ç¡®ä¿æ‰€éœ€é•œåƒå­˜åœ¨"""
        for language, image in self.images.items():
            try:
                self.client.images.get(image)
                print(f"âœ“ é•œåƒ {image} å·²å­˜åœ¨")
            except docker.errors.ImageNotFound:
                print(f"â¬‡ æ­£åœ¨æ‹‰å–é•œåƒ {image}...")
                self.client.images.pull(image)
                print(f"âœ“ é•œåƒ {image} æ‹‰å–å®Œæˆ")

    def _get_extension(self, language: str) -> str:
        return {'python': 'py', 'javascript': 'js'}.get(language, 'txt')

    def _get_command(self, language: str, filename: str) -> list:
        commands = {
            'python': ['python', filename],
            'javascript': ['node', filename]
        }
        return commands.get(language, ['cat', filename])


# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    sandbox = DockerSandbox(timeout=10, memory_limit="64m")

    # æµ‹è¯•Pythonä»£ç 
    python_code = """
import math
print("Dockeræ²™ç®±ä¸­çš„Pythonæ‰§è¡Œ")
print(f"Ï€çš„å€¼: {math.pi}")
print(f"2çš„å¹³æ–¹æ ¹: {math.sqrt(2)}")
"""

    result = sandbox.execute(python_code, "python")
    print("Dockeræ‰§è¡Œç»“æœï¼š", result)
```

## ğŸ¯ å­¦ä¹ é‡ç‚¹å’Œå¯¹æ¯”

### JavaScript å¼€å‘è€…çš„ç†è§£è·¯å¾„

| æ¦‚å¿µ     | JavaScript ç­‰ä»·         | Python æ²™ç®±å®ç°        |
| -------- | ----------------------- | ---------------------- |
| è¿›ç¨‹éš”ç¦» | `child_process.spawn()` | `subprocess.run()`     |
| ä»£ç æ‰§è¡Œ | `vm.runInNewContext()`  | `exec()` in subprocess |
| å®¹å™¨åŒ–   | Docker for Node.js      | Docker for Python      |
| èµ„æºé™åˆ¶ | `--max-old-space-size`  | `resource.setrlimit()` |
| è¶…æ—¶æ§åˆ¶ | `setTimeout()`          | `timeout` parameter    |

### æ ¸å¿ƒå®‰å…¨æ¦‚å¿µ

1. **è¾“å…¥éªŒè¯**ï¼šæ£€æŸ¥å±é™©ä»£ç æ¨¡å¼
2. **èµ„æºé™åˆ¶**ï¼šå†…å­˜ã€CPUã€æ—¶é—´æ§åˆ¶
3. **è¿›ç¨‹éš”ç¦»**ï¼šç‹¬ç«‹è¿›ç¨‹ç©ºé—´
4. **å®¹å™¨éš”ç¦»**ï¼šDocker å®Œå…¨éš”ç¦»
5. **ç½‘ç»œéš”ç¦»**ï¼šç¦ç”¨ç½‘ç»œè®¿é—®

## ğŸ“‹ å®è·µè®¡åˆ’

### ç¬¬ 1 å¤©ï¼šåŸºç¡€æ²™ç®±

- [ ] ç†è§£ `subprocess` æ¨¡å—
- [ ] å®ç° `SimpleSandbox` ç±»
- [ ] æµ‹è¯•åŸºæœ¬ä»£ç æ‰§è¡Œ
- [ ] æ·»åŠ è¶…æ—¶ä¿æŠ¤

### ç¬¬ 2 å¤©ï¼šå®‰å…¨å¢å¼º

- [ ] å­¦ä¹ ä»£ç å®‰å…¨æ£€æŸ¥
- [ ] å®ç° `SafeSandbox` ç±»
- [ ] æ·»åŠ èµ„æºé™åˆ¶
- [ ] æµ‹è¯•å±é™©ä»£ç æ‹¦æˆª

### ç¬¬ 3 å¤©ï¼šDocker é›†æˆ

- [ ] å­¦ä¹  Docker åŸºç¡€å‘½ä»¤
- [ ] å®‰è£… Docker Python SDK
- [ ] å®ç° `DockerSandbox` ç±»
- [ ] æµ‹è¯•å®¹å™¨éš”ç¦»

### ç¬¬ 4 å¤©ï¼šé›†æˆæµ‹è¯•

- [ ] ç¼–å†™å®Œæ•´æµ‹è¯•ç”¨ä¾‹
- [ ] æ€§èƒ½æµ‹è¯•å’Œä¼˜åŒ–
- [ ] æ–‡æ¡£å®Œå–„
- [ ] éƒ¨ç½²å‡†å¤‡

## ğŸš€ å¿«é€Ÿå¼€å§‹

1. **å…‹éš†é¡¹ç›®ç»“æ„**ï¼š

```bash
mkdir practical7 && cd practical7
touch stage1_simple_sandbox.py stage2_safe_sandbox.py stage3_docker_sandbox.py
```

2. **å®‰è£…ä¾èµ–**ï¼š

```bash
pip install psutil docker
```

3. **è¿è¡Œé˜¶æ®µ 1**ï¼š

```bash
python stage1_simple_sandbox.py
```

è¿™ä¸ªæ–¹æ¡ˆè®©ä½ èƒ½å¤Ÿï¼š

- **å¾ªåºæ¸è¿›**ï¼šä» 30 è¡Œä»£ç å¼€å§‹ï¼Œé€æ­¥å¢åŠ å¤æ‚åº¦
- **æ¦‚å¿µæ¸…æ™°**ï¼šæ¯ä¸ªé˜¶æ®µä¸“æ³¨ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µ
- **å®æˆ˜å¯¼å‘**ï¼šæ¯ä¸ªé˜¶æ®µéƒ½æœ‰å¯è¿è¡Œçš„å®Œæ•´ä»£ç 
- **æ˜“äºç†è§£**ï¼šé¿å…è¿‡åº¦æŠ½è±¡ï¼Œä¸“æ³¨æ ¸å¿ƒåŠŸèƒ½

ä½ è§‰å¾—è¿™ä¸ªç®€åŒ–æ–¹æ¡ˆå¦‚ä½•ï¼Ÿæˆ‘ä»¬å¯ä»¥ä»å“ªä¸ªé˜¶æ®µå¼€å§‹å®è·µï¼Ÿ
