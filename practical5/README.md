# é¡¹ç›®5ï¼šReActæ¨ç†ä»£ç†

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªåŸºäºReActï¼ˆReasoning and Actingï¼‰æ¨¡å¼çš„æ™ºèƒ½æ¨ç†ä»£ç†å®ç°ã€‚ReActæ˜¯ä¸€ç§å…ˆè¿›çš„AIæ¨ç†æ–¹æ³•ï¼Œé€šè¿‡å¾ªç¯çš„"æ€è€ƒ-è¡ŒåŠ¨-è§‚å¯Ÿ"è¿‡ç¨‹æ¥è§£å†³å¤æ‚é—®é¢˜ã€‚

### ğŸŒŸ æ ¸å¿ƒç‰¹æ€§

- **ğŸ§  ReActæ¨ç†æ¨¡å¼**ï¼šå®ç°å®Œæ•´çš„æ€è€ƒ-è¡ŒåŠ¨-è§‚å¯Ÿå¾ªç¯
- **ğŸ”§ å·¥å…·ç³»ç»Ÿé›†æˆ**ï¼šæ”¯æŒå¤šç§å·¥å…·çš„åŠ¨æ€è°ƒç”¨
- **ğŸ“Š æ‰§è¡Œè½¨è¿¹è¿½è¸ª**ï¼šå®Œæ•´è®°å½•æ¨ç†è¿‡ç¨‹ï¼Œä¾¿äºè°ƒè¯•å’Œåˆ†æ
- **âš¡ å¼‚æ­¥æ‰§è¡Œ**ï¼šé«˜æ€§èƒ½çš„å¼‚æ­¥ç¼–ç¨‹å®ç°
- **ğŸ›¡ï¸ é”™è¯¯å¤„ç†**ï¼šå®Œå–„çš„å¼‚å¸¸å¤„ç†å’Œæ¢å¤æœºåˆ¶
- **ğŸ“ˆ ç»Ÿè®¡åˆ†æ**ï¼šè¯¦ç»†çš„æ‰§è¡Œç»Ÿè®¡å’Œæ€§èƒ½ç›‘æ§

### ğŸ—ï¸ æŠ€æœ¯æ¶æ„

```
ReActAgent (ä¸»ä»£ç†)
â”œâ”€â”€ çŠ¶æ€ç®¡ç† (AgentState)
â”œâ”€â”€ æ­¥éª¤è¿½è¸ª (ReActStep)
â”œâ”€â”€ å¾ªç¯æ§åˆ¶ (solveæ–¹æ³•)
â”œâ”€â”€ å·¥å…·ç³»ç»Ÿ (å¤ç”¨é¡¹ç›®4)
â”‚   â”œâ”€â”€ ToolManager
â”‚   â”œâ”€â”€ BaseTool
â”‚   â””â”€â”€ å…·ä½“å·¥å…· (Calculator, TextProcessorç­‰)
â””â”€â”€ LLMé›†æˆ (OpenAI API)
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# å…‹éš†é¡¹ç›®ï¼ˆå¦‚æœéœ€è¦ï¼‰
cd practical5

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 2. é…ç½®è®¾ç½®

```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œè®¾ç½®ä½ çš„ OpenAI API å¯†é’¥
# OPENAI_API_KEY=your_api_key_here
```

### 3. è¿è¡Œç¨‹åº

#### æ–¹å¼ä¸€ï¼šè¿è¡Œé¢„è®¾æµ‹è¯•ç”¨ä¾‹
```bash
python main.py
```

#### æ–¹å¼äºŒï¼šäº¤äº’å¼æ¼”ç¤º
```bash
python demo.py
```

#### æ–¹å¼ä¸‰ï¼šè¿è¡Œæµ‹è¯•
```bash
python -m pytest tests/ -v
```

## ğŸ“– ä½¿ç”¨æŒ‡å—

### åŸºæœ¬ä½¿ç”¨

```python
import asyncio
from agent.react_agent import ReActAgent
from tools.manager import ToolManager
from tools.calculator import CalculatorTool

# åˆ›å»ºå·¥å…·ç®¡ç†å™¨
tool_manager = ToolManager()
calculator = CalculatorTool()
tool_manager.register_tool(calculator)

# åˆ›å»ºReActä»£ç†
agent = ReActAgent(
    tool_manager=tool_manager,
    max_steps=10,
    model="gpt-3.5-turbo"
)

# è§£å†³é—®é¢˜
async def solve_problem():
    result = await agent.solve("è®¡ç®— 15 + 27 çš„ç»“æœ")
    print(f"ç­”æ¡ˆ: {result['final_answer']}")
    print(f"æ¨ç†æ­¥æ•°: {result['total_steps']}")

asyncio.run(solve_problem())
```

### é«˜çº§é…ç½®

```python
# è‡ªå®šä¹‰ä»£ç†é…ç½®
agent = ReActAgent(
    tool_manager=tool_manager,
    max_steps=15,           # æœ€å¤§æ¨ç†æ­¥æ•°
    model="gpt-4",          # ä½¿ç”¨GPT-4æ¨¡å‹
    temperature=0.2         # é™ä½éšæœºæ€§
)
```

## ğŸ”§ å¯ç”¨å·¥å…·

### è®¡ç®—å™¨å·¥å…· (Calculator)
- **åŠŸèƒ½**ï¼šåŸºæœ¬æ•°å­¦è¿ç®—ï¼ˆåŠ ã€å‡ã€ä¹˜ã€é™¤ï¼‰
- **ç¤ºä¾‹**ï¼š`{"name": "calculator", "parameters": {"operation": "add", "a": 5, "b": 3}}`

### æ–‡æœ¬å¤„ç†å·¥å…· (TextProcessor)
- **åŠŸèƒ½**ï¼šæ–‡æœ¬è½¬æ¢ã€åˆ†æã€æ ¼å¼åŒ–
- **æ”¯æŒæ“ä½œ**ï¼š
  - å¤§å°å†™è½¬æ¢ï¼š`uppercase`, `lowercase`, `capitalize`, `title`
  - æ–‡æœ¬åˆ†æï¼š`word_count`, `char_count`, `word_frequency`
  - æ ¼å¼åŒ–ï¼š`remove_spaces`, `remove_newlines`
  - æå–ï¼š`extract_emails`, `extract_urls`
  - æ›¿æ¢ï¼š`replace`

## ğŸ“Š ç¤ºä¾‹é—®é¢˜

### ç®€å•è®¡ç®—
```
é—®é¢˜ï¼šè®¡ç®— 25 * 4 + 15 çš„ç»“æœ
```

### å¤æ‚æ¨ç†
```
é—®é¢˜ï¼šå¦‚æœä¸€ä¸ªé•¿æ–¹å½¢çš„é•¿æ˜¯12ï¼Œå®½æ˜¯8ï¼Œé‚£ä¹ˆå®ƒçš„é¢ç§¯æ˜¯å¤šå°‘ï¼Ÿå‘¨é•¿åˆæ˜¯å¤šå°‘ï¼Ÿ
```

### æ–‡æœ¬å¤„ç†
```
é—®é¢˜ï¼šå°†æ–‡æœ¬'Hello World'è½¬æ¢ä¸ºå¤§å†™ï¼Œç„¶åç»Ÿè®¡å­—ç¬¦æ•°é‡
```

### ç»¼åˆä»»åŠ¡
```
é—®é¢˜ï¼šæˆ‘æœ‰ä¸€æ®µæ–‡æœ¬'The quick brown fox jumps over the lazy dog'ï¼Œè¯·å¸®æˆ‘ï¼š
1ï¼‰ç»Ÿè®¡å•è¯æ•°é‡
2ï¼‰è½¬æ¢ä¸ºå¤§å†™
3ï¼‰è®¡ç®—å¦‚æœæ¯ä¸ªå•è¯ä»·å€¼5å…ƒï¼Œæ€»ä»·å€¼æ˜¯å¤šå°‘ï¼Ÿ
```

## ğŸƒâ€â™‚ï¸ æ¨ç†è¿‡ç¨‹ç¤ºä¾‹

```
ğŸ¤” æ­£åœ¨æ€è€ƒé—®é¢˜: è®¡ç®— 15 + 27 çš„ç»“æœ
============================================================

ğŸ§  æ¨ç†è¿‡ç¨‹:
----------------------------------------

ğŸ’­ æ­¥éª¤ 1 (thinking):
   æ€è€ƒ: ç”¨æˆ·è¦æ±‚è®¡ç®—15åŠ 27çš„ç»“æœï¼Œæˆ‘éœ€è¦ä½¿ç”¨è®¡ç®—å™¨å·¥å…·æ¥å®Œæˆè¿™ä¸ªè®¡ç®—ã€‚
   è¡ŒåŠ¨: {"name": "calculator", "parameters": {"operation": "add", "a": 15, "b": 27}}
   è§‚å¯Ÿ: å·¥å…·æ‰§è¡ŒæˆåŠŸ: {"operation": "add", "a": 15, "b": 27, "result": 42}
   è€—æ—¶: 0.156ç§’

âœ… æ­¥éª¤ 2 (finished):
   æ€è€ƒ: æˆ‘å·²ç»ä½¿ç”¨è®¡ç®—å™¨å·¥å…·æˆåŠŸè®¡ç®—å‡º15 + 27 = 42ã€‚
   è§‚å¯Ÿ: æœ€ç»ˆç­”æ¡ˆ: 15 + 27 = 42
   è€—æ—¶: 0.089ç§’

============================================================
âœ… æœ€ç»ˆç­”æ¡ˆ: 15 + 27 = 42

ğŸ“ˆ æ‰§è¡Œç»Ÿè®¡:
   æ¨ç†æ­¥æ•°: 2
   æ€»è€—æ—¶: 0.67ç§’
   å¹³å‡æ¯æ­¥: 0.34ç§’
   ä½¿ç”¨å·¥å…·: calculator
```

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæ‰€æœ‰æµ‹è¯•
```bash
python -m pytest tests/ -v
```

### è¿è¡Œç‰¹å®šæµ‹è¯•
```bash
python -m pytest tests/test_react_agent.py::TestReActAgent::test_agent_initialization -v
```

### æµ‹è¯•è¦†ç›–ç‡
```bash
pip install pytest-cov
python -m pytest tests/ --cov=agent --cov=tools --cov=utils
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
practical5/
â”œâ”€â”€ agent/                    # ä»£ç†æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ react_agent.py        # ReActä»£ç†å®ç°
â”œâ”€â”€ tools/                    # å·¥å…·æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ base.py               # åŸºç¡€å·¥å…·ç±»
â”‚   â”œâ”€â”€ manager.py            # å·¥å…·ç®¡ç†å™¨
â”‚   â”œâ”€â”€ calculator.py         # è®¡ç®—å™¨å·¥å…·
â”‚   â””â”€â”€ text_processor.py     # æ–‡æœ¬å¤„ç†å·¥å…·
â”œâ”€â”€ utils/                    # å·¥å…·ç±»æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ config.py             # é…ç½®ç®¡ç†
â”‚   â””â”€â”€ logger.py             # æ—¥å¿—ç®¡ç†
â”œâ”€â”€ tests/                    # æµ‹è¯•æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ test_react_agent.py   # ReActä»£ç†æµ‹è¯•
â”œâ”€â”€ logs/                     # æ—¥å¿—æ–‡ä»¶ç›®å½•
â”œâ”€â”€ .env.example              # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ requirements.txt          # ä¾èµ–åŒ…åˆ—è¡¨
â”œâ”€â”€ main.py                   # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ demo.py                   # äº¤äº’å¼æ¼”ç¤º
â””â”€â”€ README.md                 # é¡¹ç›®æ–‡æ¡£
```

## ğŸ” æ ¸å¿ƒæ¦‚å¿µ

### ReActæ¨¡å¼
ReActï¼ˆReasoning and Actingï¼‰æ˜¯ä¸€ç§ç»“åˆæ¨ç†å’Œè¡ŒåŠ¨çš„AIæ–¹æ³•ï¼š

1. **Thoughtï¼ˆæ€è€ƒï¼‰**ï¼šåˆ†æå½“å‰æƒ…å†µï¼Œå†³å®šä¸‹ä¸€æ­¥è¡ŒåŠ¨
2. **Actionï¼ˆè¡ŒåŠ¨ï¼‰**ï¼šæ‰§è¡Œå…·ä½“çš„å·¥å…·è°ƒç”¨
3. **Observationï¼ˆè§‚å¯Ÿï¼‰**ï¼šè·å–è¡ŒåŠ¨ç»“æœï¼Œä¸ºä¸‹ä¸€è½®æ€è€ƒæä¾›ä¿¡æ¯

### çŠ¶æ€æœºè®¾è®¡
ä»£ç†ä½¿ç”¨çŠ¶æ€æœºç®¡ç†æ¨ç†è¿‡ç¨‹ï¼š

- `THINKING`ï¼šæ€è€ƒé˜¶æ®µ
- `ACTING`ï¼šè¡ŒåŠ¨é˜¶æ®µ  
- `OBSERVING`ï¼šè§‚å¯Ÿé˜¶æ®µ
- `FINISHED`ï¼šå®ŒæˆçŠ¶æ€
- `ERROR`ï¼šé”™è¯¯çŠ¶æ€

### æç¤ºè¯å·¥ç¨‹
ç²¾å¿ƒè®¾è®¡çš„æç¤ºè¯ç¡®ä¿LLMæŒ‰ç…§ReActæ ¼å¼è¾“å‡ºï¼š

```
Thought: [æ€è€ƒè¿‡ç¨‹]
Action: {"name": "å·¥å…·å", "parameters": {...}}
Observation: [ç³»ç»Ÿè‡ªåŠ¨å¡«å…¥]

æˆ–è€…ï¼š

Thought: [æœ€ç»ˆæ€è€ƒ]
Final Answer: [æœ€ç»ˆç­”æ¡ˆ]
```

## âš™ï¸ é…ç½®é€‰é¡¹

### ç¯å¢ƒå˜é‡

| å˜é‡å | æè¿° | é»˜è®¤å€¼ |
|--------|------|--------|
| `OPENAI_API_KEY` | OpenAI APIå¯†é’¥ | å¿…éœ€ |
| `OPENAI_MODEL` | ä½¿ç”¨çš„æ¨¡å‹ | `gpt-3.5-turbo` |
| `LOG_LEVEL` | æ—¥å¿—çº§åˆ« | `INFO` |
| `MAX_CONCURRENT_TOOLS` | æœ€å¤§å¹¶å‘å·¥å…·æ•° | `5` |
| `TOOL_TIMEOUT` | å·¥å…·è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰ | `30` |

### ä»£ç†å‚æ•°

| å‚æ•° | æè¿° | é»˜è®¤å€¼ |
|------|------|--------|
| `max_steps` | æœ€å¤§æ¨ç†æ­¥æ•° | `10` |
| `model` | LLMæ¨¡å‹ | `gpt-3.5-turbo` |
| `temperature` | ç”Ÿæˆæ¸©åº¦ | `0.1` |

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **APIå¯†é’¥é”™è¯¯**
   ```
   é”™è¯¯ï¼šæœªè®¾ç½®OpenAI APIå¯†é’¥
   è§£å†³ï¼šåœ¨.envæ–‡ä»¶ä¸­è®¾ç½®OPENAI_API_KEY
   ```

2. **å·¥å…·æ‰§è¡Œå¤±è´¥**
   ```
   æ£€æŸ¥å·¥å…·å‚æ•°æ˜¯å¦æ­£ç¡®
   æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶äº†è§£è¯¦ç»†é”™è¯¯ä¿¡æ¯
   ```

3. **æ¨ç†å¾ªç¯è¿‡é•¿**
   ```
   è°ƒæ•´max_stepså‚æ•°
   æ£€æŸ¥æç¤ºè¯æ˜¯å¦æ¸…æ™°
   ```

### è°ƒè¯•æŠ€å·§

1. **å¯ç”¨è¯¦ç»†æ—¥å¿—**
   ```python
   # åœ¨.envä¸­è®¾ç½®
   LOG_LEVEL=DEBUG
   ```

2. **æŸ¥çœ‹æ‰§è¡Œè½¨è¿¹**
   ```python
   result = await agent.solve("é—®é¢˜")
   for step in result['execution_trace']:
       print(f"æ­¥éª¤ {step['step_number']}: {step['thought']}")
   ```

3. **ç›‘æ§å·¥å…·ä½¿ç”¨**
   ```python
   stats = tool_manager.get_stats()
   print(stats)
   ```

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

- OpenAI æä¾›çš„å¼ºå¤§API
- ReActè®ºæ–‡çš„åŸå§‹ä½œè€…
- Pythonå¼‚æ­¥ç¼–ç¨‹ç¤¾åŒº

## ğŸ“š å­¦ä¹ èµ„æº

- [ReActè®ºæ–‡](https://arxiv.org/abs/2210.03629)
- [OpenAI APIæ–‡æ¡£](https://platform.openai.com/docs)
- [Pythonå¼‚æ­¥ç¼–ç¨‹æŒ‡å—](https://docs.python.org/3/library/asyncio.html)
- [Pydanticæ–‡æ¡£](https://pydantic-docs.helpmanual.io/)

---

**é¡¹ç›®5å®Œæˆï¼ğŸ‰** 

è¿™ä¸ªReActæ¨ç†ä»£ç†å±•ç¤ºäº†å¦‚ä½•æ„å»ºä¸€ä¸ªèƒ½å¤Ÿè¿›è¡Œå¤æ‚æ¨ç†çš„AIç³»ç»Ÿã€‚é€šè¿‡å¾ªç¯çš„æ€è€ƒ-è¡ŒåŠ¨-è§‚å¯Ÿè¿‡ç¨‹ï¼Œä»£ç†èƒ½å¤Ÿè§£å†³éœ€è¦å¤šæ­¥æ¨ç†å’Œå·¥å…·è°ƒç”¨çš„å¤æ‚é—®é¢˜ã€‚